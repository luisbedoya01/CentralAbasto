<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="text-center">Gestión de Inventario</h2>
    <button matButton="filled" id="btnAgregarProducto" class="btn btn-primary d-flex align-items-center gap-2"
      (click)="agregarProducto()">
      <mat-icon>add</mat-icon>
      Nuevo Producto
    </button>
  </div>

  <!-- Filtro de búsqueda -->
  <div class="mb-3">
    <div class="col-md-4">
      <input type="text" class="form-control" placeholder="Buscar producto..." [(ngModel)]="filtro"
        (ngModelChange)="filtrarProductos()">
    </div>
  </div>

  <!-- Tabla con los productos -->
  <div class="table-responsive">
    <table class="table table-striped table-bordered">
      <thead class="table-dark">
        <tr>
          <!-- <th>Código</th> -->
          <th>Nombre</th>
          <!-- <th>Precio</th> -->
          <th>Categoría</th>
          <th style="width: 15%; min-width: 200px;">Proveedor</th>
          <th>Marca</th>
          <th>Estado</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let producto of productosPaginados">
          <!-- <td> {{ producto.Codigo_Producto }}</td> -->
          <td>{{ producto.Nombre_Producto }}</td>
          <!-- <td>{{ producto.Precio_Compra | currency }}</td> -->
          <td>{{ producto.Categoria }}</td>
          <td>{{ producto.Nombre_Proveedor}}</td>
          <td>{{ producto.Nombre_Marca }}</td>
          <td>
            <!-- <span class="badge" [ngClass]="{
                            'bg-success': producto.Estado === 'Activo',
                            'bg-danger': producto.Estado === 'Inactivo'
                        }">
              {{ producto.Estado }}
            </span> -->
            <span class="badge" [ngClass]="{
                            'bg-success': producto.IdEstado === 1,
                            'bg-danger': producto.Estado === 3
                        }">
              {{ producto.Estado }}
            </span>
          </td>
          <td>
            <div class="d-flex gap-1 justify-content-center">
              <button class="btn btn-secondary btn-sm d-flex align-items-center gap-1"
                (click)="agregarStockProducto(producto)" [title]="'Agregar stock a - ' + producto.Nombre_Producto">
                <mat-icon>add</mat-icon>
                <!-- Stock -->
              </button>
              <button class="btn btn-warning btn-sm d-flex align-items-center gap-1" (click)="editarProducto(producto)"
                [title]="'Editar - ' + producto.Nombre_Producto">
                <mat-icon>edit</mat-icon>
                <!-- Editar -->
              </button>
              <button class="btn btn-danger btn-sm d-flex align-items-center gap-1" (click)="eliminarProducto(producto)"
                [title]="'Eliminar - ' + producto.Nombre_Producto">
                <mat-icon>delete</mat-icon>
                <!-- Eliminar -->
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="mensajeNoResultados" class="alert alert-warning text-center" role="alert">{{mensajeNoResultados}}</div>
</div>



<!-- Paginado de la tabla -->
<div class="d-flex justify-content-center align-items-center gap-4 mb-3">
  <!-- Selector de elementos por página -->
  <div>
    Mostrar
    <select [(ngModel)]="itemsPorPagina" (change)="cambiarItemsPorPagina()"
      class="form-select d-inline-block w-auto ms-2">
      <option *ngFor="let cantidad of opcionesPorPagina" [value]="cantidad">{{ cantidad }}</option>
    </select>
    elementos
  </div>

  <!-- Paginación -->
  <nav *ngIf="paginasTotales > 1">
    <!-- clase anterior: pagination justify-content-center  -->
    <ul class="pagination mb-0">
      <li class="page-item" [class.disabled]="paginaActual === 1">
        <a class="page-link" (click)="cambiarPagina(paginaActual - 1)">Anterior</a>
      </li>

      <li class="page-item" *ngFor="let pagina of [].constructor(paginasTotales); let i = index"
        [class.active]="paginaActual === i + 1">
        <a class="page-link" (click)="cambiarPagina(i + 1)">{{ i + 1 }}</a>
      </li>

      <li class="page-item" [class.disabled]="paginaActual === paginasTotales">
        <a class="page-link" (click)="cambiarPagina(paginaActual + 1)">Siguiente</a>
      </li>
    </ul>
  </nav>
</div>


<!-- Modal para agregar/editar producto -->
<div class="modal" *ngIf="isModalVisible">
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title">{{modoEdicion ? 'Editar Producto' : 'Agregar Nuevo Producto'}}</h5>
      <button class="close-btn" (click)="cerrarModal()">X</button>
    </div>
    <div class="modal-body">
      <form [formGroup]="productoForm" (ngSubmit)="guardarProducto()">
        <div class="row mb-3">
          <div class="col-md-4">
            <b><label for="codigoProducto" class="form-label">Código:</label></b>
            <input type="text" id="codigoProducto" class="form-control" formControlName="CodigoProducto">
          </div>
          <div class="col-md-4">
            <b><label for="nombreProducto" class="form-label">Nombre:</label></b>
            <input type="text" id="nombreProducto" class="form-control" formControlName="Nombre">
          </div>
        </div>

        <div class="row mb-3">
          <div class="col-md-6">
            <b><label for="categoriaProducto" class="form-label">Categoría:</label></b>
            <select id="categoriaProducto" class="form-control" formControlName="IdCategoria">
              <option value="" disabled>Seleccionar categoría</option>
              <option *ngFor="let categoria of categorias" [value]="categoria.Id_Categoria">{{
                categoria.Nombre_Categoria }}</option>
            </select>
          </div>
          <div class="col-md-4 mt-4">
            <button type="button" class="btn btn-secondary mt-2 d-flex align-items-center gap-1"
              (click)="abrirModalCategoria()">
              <mat-icon>add_circle</mat-icon> Agregar categoria
            </button>
          </div>
        </div>

        <div class="row mb-3">
          <div class="col-md-6">
            <b><label for="marcaProducto" class="form-label">Marca:</label></b>
            <select id="marcaProducto" class="form-control" formControlName="IdMarca">
              <option value="" disabled>Seleccionar marca</option>
              <option *ngFor="let marca of marcas" [value]="marca.IdMarca">{{ marca.NombreMarca }}</option>
            </select>
          </div>
          <div class="col-md-4 mt-4">
            <button type="button" class="btn btn-secondary mt-2 d-flex align-items-center gap-1"
              (click)="abrirModalMarca()">
              <mat-icon>add_circle</mat-icon> Agregar marca
            </button>
          </div>
        </div>

        <div class="row mb-3">
          <div class="col-md-4">
            <b><label for="unidadConversion" class="form-label">Unidad de conversión:</label></b>
            <!-- <input type="number" id="unidadConversion" class="form-control" formControlName="IdUnidadConversionVenta"> -->
            <select id="unidadConversion" class="form-control" formControlName="IdUnidadConversionVenta">
              <option value="" disabled>Seleccionar unidad de conversión de venta</option>
              <option *ngFor="let medida of medidas" [value]="medida.Id_Medida">
                {{ medida.Nombre_Medida_Principal }} -> {{ medida.Nombre_Medida_Convertir }}</option>
            </select>
          </div>
          <div class="col-md-4">
            <b><label for="stockInicial" class="form-label">Stock:</label></b>
            <input type="number" id="stockInicial" class="form-control" formControlName="Stock">
          </div>
          <div class="col-md-4">
            <b><label for="stockMaximo" class="form-label">Stock máximo:</label></b>
            <input type="number" id="stockMaximo" class="form-control" formControlName="StockMaximo">
          </div>
          <div class="col-md-4">
            <b><label for="stockMinimo" class="form-label">Stock mínimo:</label></b>
            <input type="number" id="stockMinimo" class="form-control" formControlName="StockMinimo">
          </div>
        </div>

        <div class="row mb-3">
          <div class="col-md-6">
            <b><label for="proveedor" class="form-label">Proveedor:</label></b>
            <select id="proveedor" class="form-control" formControlName="IdProveedor">
              <option value="" disabled>Seleccionar proveedor</option>
              <option *ngFor="let proveedor of proveedores" [value]="proveedor.IdProveedor">{{
                proveedor.NombreProveedor }}</option>
            </select>
          </div>
          <div class="col-md-4 mt-4">
            <button type="button" class="btn btn-secondary mt-2 d-flex align-items-center gap-1"
              (click)="abrirModalProveedor()">
              <mat-icon>add_circle</mat-icon> Agregar proveedor
            </button>
          </div>
        </div>

        <div class="row mb-3">
          <div class="col-md-6 form-check">
            <input type="checkbox" id="productoPerecible" class="form-check-input" formControlName="esPerecible">
            <label for="productoPerecible" class="form-check-label">¿Es perecible?</label>
          </div>
          <div *ngIf="productoForm.get('esPerecible')?.value" class="col-md-6 mt-2">
            <b><label for="fechaVencimiento" class="form-label">Fecha de vencimiento:</label></b>
            <input type="date" id="fechaVencimiento" class="form-control" formControlName="FechaVencimiento">
          </div>
        </div>

        <div class="row mb-3">
          <div class="col-md-6">
            <b><label for="precioProductoCompra" class="form-label">Precio de compra:</label></b>
            <input type="number" id="precioProductoCompra" class="form-control" formControlName="PrecioCompra">
          </div>
          <div class="col-md-6">
            <b><label for="porcentajeProducto" class="form-label">Porcentaje de ganancia:</label></b>
            <input type="number" id="porcentajeProducto" class="form-control" formControlName="PorcentajeGanancia">
          </div>
        </div>
        <div *ngIf="modoEdicion" class="row mb-3">
          <div class="col-md-8 d-flex align-items-center gap-4">
            <b><label for="precioProductoVenta" class="form-label">Precio de venta:</label></b>
            <!-- <input type="number" id="precioProductoCompra" class="form-control" formControlName="PrecioVenta"> -->
            <button type="button" class="btn btn-secondary mt-2 d-flex align-items-center gap-2"
              (click)="abrirModalPrecioVenta()">
              <mat-icon>add_circle</mat-icon> Agregar precio de venta</button>
          </div>
          <div class="row mb-3">
            <div class="col-md-6" *ngIf="preciosVentas.length === 0">
              <p style="margin-top: 5px;">No hay precios de venta disponibles. Agregue uno primero.</p>
            </div>
          </div>
          <div class="table-responsive" *ngIf="preciosVentas.length > 0">
            <table class="table table-striped table-bordered">
              <thead class="table-dark">
                <tr>
                  <th>Unidad de medida</th>
                  <th>Precio de venta</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let precio of preciosVentas">
                  <td>{{ precio.UnidadMedida }}</td>
                  <td>{{ precio.PrecioVenta | currency }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="row mb-3">
          <div class="col-md-6 form-check">
            <input type="checkbox" id="ImpuestoProducto" class="form-check-input" formControlName="ImpuestoProducto">
            <label for="ivaProducto" class="form-check-label">Producto con IVA</label>
          </div>
          <div class="col-md-6 form-check">
            <input type="checkbox" id="VentaGranel" class="form-check-input" formControlName="VentaGranel">
            <label for="ivaProducto" class="form-check-label">¿Producto se puede vendar a granel?</label>
          </div>
        </div>
        <div *ngIf="modoEdicion" class="mb-3">
          <label for="estadoProducto" class="form-label">Estado</label>
          <select id="estadoProducto" class="form-control" formControlName="Id_Estado">
            <option value="" disabled>Seleccionar estado</option>
            <option *ngFor="let estado of estados" [value]="estado.Id_Estado">{{ estado.Nombre_Estado }}</option>
          </select>
        </div>
        <div class="d-flex gap-1">
          <!-- Botón Guardar (Cuando se agrega un nuevo producto) -->
          <button *ngIf="!modoEdicion" type="submit" class="btn btn-primary d-flex align-items-center gap-1"
            [disabled]="productoForm.invalid">
            <mat-icon>save</mat-icon> Guardar
          </button>
          <!-- Botón Actualizar (Cuando se edita un producto) -->
          <button *ngIf="modoEdicion" type="submit" class="btn btn-warning d-flex align-items-center gap-1"
            [disabled]="productoForm.invalid">
            <mat-icon>edit</mat-icon> Actualizar
          </button>
          <!-- Botón Cancelar -->
          <button type="button" class="btn btn-danger d-flex align-items-center gap-1" (click)="cerrarModal()">
            <mat-icon>not_interested</mat-icon> Cancelar
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Modal de Confirmación de Eliminación -->
<div class="modal" *ngIf="isConfirmDeleteModalVisible">
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title">Confirmación de Eliminación</h5>
      <button class="close-btn" (click)="cerrarModalDelete()">X</button>
    </div>
    <div class="modal-body">
      <p>¿Está seguro de eliminar este producto?</p>
    </div>
    <div class="modal-footer">
      <div class="d-flex gap-1">
        <button type="button" class="btn btn-secondary d-flex align-items-center gap-1" (click)="cerrarModalDelete()">
          <mat-icon>not_interested</mat-icon> Cancelar
        </button>
        <button type="button" class="btn btn-danger d-flex align-items-center gap-1"
          (click)="eliminarProductoConfirmado()">
          <mat-icon>dangerous</mat-icon> Eliminar
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Modal para agregar categoria -->
<div class="modal" *ngIf="isModalCategoriaVisible">
  <div class="modal-content-secundario">
    <div class="modal-header">
      <h5 class="modal-title">Agregar Categoría</h5>
      <button class="close-btn" (click)="cerrarModalCategoria()">X</button>
    </div>
    <div class="modal-body">
      <form [formGroup]="categoriaForm" (ngSubmit)="guardarCategoria()">
        <div class="row mb-3">
          <div class="col-md-6">
            <label for="nombreCategoria" class="form-label">Nombre de la Categoría</label>
            <input type="text" id="nombreCategoria" class="form-control" formControlName="Nombre" required>
          </div>
          <div class="col-md-6">
            <label for="descripcionCategoria" class="form-label">Descripcion</label>
            <input type="text" id="descripcionCategoria" class="form-control" formControlName="Descripcion">
          </div>
        </div>
        <div class="d-flex gap-1">
          <button type="submit" class="btn btn-primary d-flex align-items-center gap-1"
            [disabled]="categoriaForm.invalid">
            <mat-icon>save</mat-icon> Guardar
          </button>
          <button type="button" class="btn btn-danger d-flex align-items-center gap-1" (click)="cerrarModalCategoria()">
            <mat-icon>not_interested</mat-icon>Cancelar</button>
        </div>
      </form>
    </div>
  </div>
</div>


<!-- Modal para agregar marca -->
<div class="modal" *ngIf="isModalMarcaVisible">
  <div class="modal-content-secundario">
    <div class="modal-header">
      <h5 class="modal-title">Agregar Marca</h5>
      <button class="close-btn" (click)="cerrarModalMarca()">X</button>
    </div>
    <div class="modal-body">
      <form [formGroup]="marcaForm" (ngSubmit)="guardarMarca()">
        <div class="row mb-3">
          <div class="col-md-6">
            <b><label for="nombreMarca" class="form-label">Nombre de la marca:</label></b>
            <input type="text" id="nombreMarca" class="form-control" formControlName="Nombre" required>
          </div>
        </div>
        <div class="d-flex gap-1">
          <button type="submit" class="btn btn-primary d-flex align-items-center gap-1" [disabled]="marcaForm.invalid">
            <mat-icon>save</mat-icon>Guardar</button>
          <button type="button" class="btn btn-danger d-flex align-items-center gap-1" (click)="cerrarModalMarca()">
            <mat-icon>not_interested</mat-icon>Cancelar</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Modal para agregar el proveedor -->
<div class="modal" *ngIf="isModalProveedorVisible">
  <div class="modal-content-secundario">
    <div class="modal-header">
      <h5 class="modal-title">Agregar proveedor</h5>
      <button class="close-btn" (click)="cerrarModalProveedor()">X</button>
    </div>
    <div class="modal-body">
      <form [formGroup]="proveedorForm" (ngSubmit)="guardarProveedor()">
        <div class="row mb-3">
          <div class="col-md-6">
            <b><label for="rucProveedor" class="form-label">RUC del Proveedor:</label></b>
            <input type="text" id="rucProveedor" class="form-control" formControlName="Ruc" required
              pattern="^[0-9]{13}$">
            <div
              *ngIf="proveedorForm.get('Ruc')?.invalid && (proveedorForm.get('Ruc')?.touched || proveedorForm.get('Ruc')?.dirty)"
              class="text-danger">
              El RUC debe ser exactamente de 13 dígitos numéricos.
            </div>
          </div>
          <div class="col-md-6">
            <b><label for="nombreProveedor" class="form-label">Nombre del Proveedor:</label></b>
            <input type="text" id="nombreProveedor" class="form-control" formControlName="Nombre" required>
          </div>
        </div>
        <div class="row mb-3">
          <div class="col-md-6">
            <b><label for="direccionProveedor" class="form-label">Dirección del Proveedor:</label></b>
            <input type="text" id="direccionProveedor" class="form-control" formControlName="Direccion" required>
          </div>
          <div class="col-md-6">
            <b><label for="telefonoProveedor" class="form-label">Teléfono del Proveedor</label></b>
            <input type="text" id="telefonoProveedor" class="form-control" formControlName="Telefono" required
              pattern="^[0-9]{10}$">
            <div
              *ngIf="proveedorForm.get('Telefono')?.invalid && (proveedorForm.get('Telefono')?.touched || proveedorForm.get('Telefono')?.dirty)"
              class="text-danger">
              El teléfono deben ser 10 dígitos numéricos.
            </div>
          </div>
        </div>
        <div class="d-flex gap-1">
          <button type="submit" class="btn btn-primary d-flex align-items-center gap-1"
            [disabled]="proveedorForm.invalid">
            <mat-icon>save</mat-icon>Guardar</button>
          <button type="button" class="btn btn-danger d-flex align-items-center gap-1" (click)="cerrarModalProveedor()">
            <mat-icon>not_interested</mat-icon>Cancelar</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Modal con precios de venta -->
<div class="modal" *ngIf="isModalPrecioVentaVisible">
  <div class="modal-content-secundario">
    <div class="modal-header">
      <h5 class="modal-title">Precios de venta del producto</h5>
      <button class="close-btn" (click)="cerrarModalPrecioVenta()">X</button>
    </div>
    <div class="modal-body">
      <div *ngIf="preciosVentas.length === 0">
        <p>No hay precios de venta disponibles. Agrega uno primero.</p>
      </div>
      <div class="text-end mb-3">
        <button id="btnAgregarPrecioVenta" class="btn btn-primary d-flex align-items-center gap-2"
          (click)="agregarPrecioVenta()">
          <mat-icon>add</mat-icon>Agregar Precio de Venta
        </button>
      </div>
      <div class="table-responsive" *ngIf="preciosVentas.length > 0">
        <table class="table table-striped table-bordered">
          <thead class="table-dark">
            <tr>
              <th>Unidad de medida</th>
              <th>Precio de venta</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let precio of preciosVentas">
              <td>{{ precio.UnidadMedida }}</td>
              <td>{{ precio.PrecioVenta | currency }}</td>
              <td>
                <div class="d-flex align-items-center gap-1">
                  <button class="btn btn-warning btn-sm d-flex align-items-center gap-1"
                    (click)="editarPrecioVenta(precio)"><mat-icon>search</mat-icon>Editar</button>
                  <button class="btn btn-danger btn-sm d-flex align-items-center gap-1"
                    (click)="eliminarPrecioVenta(precio)"><mat-icon>delete</mat-icon> Eliminar</button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<!-- Modal para agregar/editar los precios de venta  -->
<div class="modal" *ngIf="isModalAgregarPrecioVentaVisible">
  <div class="modal-content-secundario">
    <div class="modal-header">
      <h5 class="modal-title">{{ modoEdicionPrecioVenta ? 'Editar Precio de Venta' : 'Agregar Precio de Venta'}}</h5>
      <button class="close-btn" (click)="cerrarModalAgregarPrecioVenta()">X</button>
    </div>
    <div class="modal-body">
      <form [formGroup]="precioVentaForm" (ngSubmit)="guardarPrecioVenta()">
        <div class="row mb-3">
          <div class="col-md-6">
            <b><label for="unidadMedida" class="form-label">Unidad de medida:</label></b>
            <select id="unidadMedida" class="form-control" formControlName="IdUnidadMedida">
              <option value="" disabled>Seleccionar unidad de medida</option>
              <option *ngFor="let unidad of unidades" [value]="unidad.IdUnidad">{{
                unidad.NombreUnidad }}</option>
            </select>
          </div>
          <div class="col-md-4 mt-4">
            <button type="button" class="btn btn-secondary mt-2 d-flex align-items-center gap-1"
              (click)="abrirModalUnidadMedida()">
              <mat-icon>add</mat-icon> Agregar
              unidad</button>
          </div>
        </div>
        <div class="row mb-3">
          <div class="col-md-6">
            <b><label for="precioVenta" class="form-label">Precio de venta:</label></b>
            <input type="number" id="precioVenta" class="form-control" formControlName="PrecioVenta" required>
          </div>
        </div>
        <div class="d-flex gap-1">
          <button *ngIf="!modoEdicionPrecioVenta" type="submit" class="btn btn-primary d-flex align-items-center gap-1"
            [disabled]="precioVentaForm.invalid">
            <mat-icon>save</mat-icon> Guardar</button>
          <button *ngIf="modoEdicionPrecioVenta" type="submit" class="btn btn-warning d-flex align-items-center gap-1"
            [disabled]="precioVentaForm.invalid">
            <mat-icon>edit</mat-icon> Actualizar</button>
          <button type="button" class="btn btn-danger d-flex align-items-center gap-1"
            (click)="cerrarModalAgregarPrecioVenta()">
            <mat-icon>not_interested</mat-icon> Cancelar</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Modal para agregar unidad de medida -->
<div class="modal" *ngIf="isModalUnidadMedidaVisible">
  <div class="modal-content-secundario">
    <div class="modal-header">
      <h5 class="modal-title">Agregar Unidad Medida</h5>
      <button class="close-btn" (click)="cerrarModalUnidadMedida()">X</button>
    </div>
    <div class="modal-body">
      <form [formGroup]="unidadForm" (ngSubmit)="guardarUnidadMedida()">
        <div class="row mb-3">
          <div class="col-md-6">
            <b><label for="nombreMarca" class="form-label">Nombre de la unidad:</label></b>
            <input type="text" id="nombreMarca" class="form-control" formControlName="Nombre" required>
          </div>
        </div>
        <div class="d-flex gap-1">
          <button type="submit" class="btn btn-primary d-flex align-items-center gap-1" [disabled]="unidadForm.invalid">
            <mat-icon>save</mat-icon> Guardar</button>
          <button type="button" class="btn btn-danger d-flex align-items-center gap-2"
            (click)="cerrarModalUnidadMedida()">
            <mat-icon>not_interested</mat-icon> Cancelar</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Modal para confirmar eliminar el precio de venta -->
<div class="modal" *ngIf="isConfirmDeleteModalVisiblePrecioVenta">
  <div class="modal-content-secundario">
    <div class="modal-header">
      <h5 class="modal-title">Confirmación de Eliminación</h5>
      <button class="close-btn" (click)="cerrarModalDeletePrecioVenta()">X</button>
    </div>
    <div class="modal-body">
      <p>¿Estás seguro de eliminar este precio de venta?</p>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" (click)="cerrarModalDeletePrecioVenta()">Cancelar</button>
      <button type="button" class="btn btn-danger" (click)="eliminarPrecioVentaConfirmado()">Eliminar</button>
    </div>
  </div>
</div>

<div class="modal" *ngIf="isModalVisibleStockProducto">
  <div class="modal-content-secundario">
    <div class="modal-header">
      <h5 class="modal-title">Agregar Stock Producto</h5>
      <button class="close-btn" (click)="cerrarModalStockProducto()">X</button>
    </div>
    <div class="modal-body">

      <form [formGroup]="stockProductoForm" (ngSubmit)="guardarStockProducto()">
        <div class="row mb-3">
          <div class="col-md-6">
            <b><label for="cantidadStock" class="form-label">Cantidad a agregar:</label></b>
            <input type="number" id="cantidadStock" class="form-control" formControlName="CantidadStock" required
              min="1">
          </div>
        </div>
        <div class="d-flex gap-1">
          <button type="submit" class="btn btn-primary d-flex align-items-center gap-1"
            [disabled]="stockProductoForm.invalid">
            <mat-icon>save</mat-icon> Guardar
          </button>
        </div>
      </form>

      <!-- Tabla con más opciones de visualización -->
      <div class="mt-3">
        <h6>Historial de Stock ({{ stockProductos.length }} registros)</h6>

        <div *ngIf="stockProductos.length > 0; else noData">
          <div class="table-responsive">
            <table class="table table-striped table-bordered">
              <thead class="table-dark">
                <tr>
                  <th>Cantidad ingresada</th>
                  <th>Fecha de ingreso</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let stock of stockProductos">
                  <td>{{ stock.Cantidad_Stock }}</td>
                  <td>{{ stock.Fecha_Ingreso | date:'dd/MM/yyyy HH:mm:ss' }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <ng-template #noData>
          <div class="alert alert-info">
            No hay registros de stock para este producto.
          </div>
        </ng-template>
      </div>

    </div>
  </div>
</div>

<!-- <div class="modal-content-secundario">
    <div class="modal-header">
      <h5 class="modal-title">Agregar Stock Producto</h5>
      <button class="close-btn" (click)="cerrarModalStockProducto()">X</button>
    </div>
    <div class="modal-body">
      <form [formGroup]="stockProductoForm" (ngSubmit)="guardarStockProducto()">
        <div class="row mb-3">
          <div class="col-md-6">
            <b><label for="cantidadStock" class="form-label">Cantidad a agregar:</label></b>
            <input type="number" id="cantidadStock" class="form-control" formControlName="CantidadStock" required
              min="1">
          </div>
        </div>
        <div class="d-flex gap-1">
          <button type="submit" class="btn btn-primary d-flex align-items-center gap-1"
            [disabled]="stockProductoForm.invalid">
            <mat-icon>save</mat-icon> Guardar</button>
        </div>
      </form>
      <div class="table-responsive" *ngIf="stockProductos.length > 0">
        <table class="table table-striped table-bordered">
          <thead class="table-dark">
            <tr>
              <th>Cantidad ingresada</th>
              <th>Fecha de ingreso</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let stock of stockProductos">
              <td>{{ stock.Cantidad_Stock }}</td>
              <td>{{ stock.Fecha_Ingreso }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div> -->